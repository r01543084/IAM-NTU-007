%THOMAS ALGORITHM
function [uk] = thomas(aj,bj,c,dj,u)

    dk = dj(2:end)-bj.*aj./dj(1:end-1);
    dk = [dj(1) dk];
    
    ck = c(2:end) - ( bj.*c(1:end-1)./dk(1:end-1) );
    ck = [c(1) ck];
    
    u(2:end-2) = (ck(1:end-1)-(aj(1:end).*uT))...
                     ./dk(1:end-1);%main equation
                 
	u(end-1) = ck(end)/dk(end);%back substitution according
    
%     dk = dj(2:end)-bj.*aj./dj(1:end-1);
%     dk = [dj(1) dk];
%     
%     ck = c(2:end) - ( bj.*c(1:end-1)./dk(1:end-1) );
%     ck = [c(1) ck];
%     
%     u(2:end-2) = (ck(1:end-1)-(aj(1:end).*uT))...
%                      ./dk(1:end-1);%main equation
%                  
% 	u(end-1) = ck(end)/dk(end);%back substitution according
